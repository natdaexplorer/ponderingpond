<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Nat's Pondering Pond</title>
<link href="https://fonts.googleapis.com/css2?family=Caveat&display=swap" rel="stylesheet">
<style>

body {
    font-family: "Caveat", cursive;
    background: #FFF9F0; /* Cream background */
    margin: 0;
    padding: 30px;
    text-align: center;
}

h1 {
    font-size: 48px;
    color: #1f4d2d;
}

.main-layout {
    display: flex;
    justify-content: center;
    align-items: flex-start;
    gap: 60px;
    margin-top: 40px;
}

/* Pond Left */
.pond-wrapper {
    position: relative;
    width: 650px;
}

.pond {
    width: 100%;
    /* Floating animation */
    animation: float 4s ease-in-out infinite;
    transform-origin: center;
}

@keyframes float {
    0%, 100% {
        transform: translateY(0);
    }
    50% {
        transform: translateY(-15px);
    }
}

.drawing-container img {
    position: absolute;
    width: 100px; /* slightly bigger */
    border: 2px solid black; /* black outline like a button */
    border-radius: 12px;
    transform: translate(-50%, -50%) scale(0);
    animation: pop 0.4s ease-out forwards, float-item 4s ease-in-out infinite;
}

@keyframes pop {
    to { transform: translate(-50%, -50%) scale(1); }
}

/* Floating animation for items - slightly delayed for natural effect */
@keyframes float-item {
    0%, 100% {
        transform: translate(-50%, -50%) scale(1) translateY(0);
    }
    50% {
        transform: translate(-50%, -50%) scale(1) translateY(-8px);
    }
}

/* Right panel tools */
.toolbox {
    width: 300px;
    text-align: center;
}

.tool-title {
    font-size: 26px;
    margin-bottom: 20px;
}

.colors-and-canvas {
    display: flex;
    gap: 18px;
}

.color-column {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.color-dot {
    width: 36px; /* slightly bigger */
    height: 36px;
    border-radius: 50%;
    cursor: pointer;
    border: 2px solid black; /* outline like a button */
    transition: transform 0.2s;
}

.color-dot:hover {
    transform: scale(1.2);
}

#draw-area {
    width: 240px;
    height: 240px;
    background: #FFF9F0; /* match cream background */
    border: 3px dashed #444;
    margin-left: 10px;
}

button {
    cursor: pointer;
    font-family: "Caveat", cursive;
    font-size: 20px;
    padding: 10px 20px;
    margin-top: 15px;
    border: 3px solid #1f4d2d; /* dark green outline */
    border-radius: 12px;
    background: #FFF9F0;
    transition: transform 0.2s;
}

button:hover {
    transform: scale(1.05);
}

/* Gallery button at bottom right */
.gallery-link {
    position: fixed;
    bottom: 30px;
    right: 30px;
    padding: 12px 20px;
    font-size: 18px;
    text-decoration: none;
    border: 3px solid #1f4d2d;
    border-radius: 12px;
    background: #FFF9F0;
    color: #1f4d2d;
    display: inline-flex;
    align-items: center;
    gap: 6px;
    transition: transform 0.2s;
}

.gallery-link:hover {
    transform: scale(1.05);
}

</style>
</head>

<body>

<h1>Nat's Pondering Pond</h1>

<div class="main-layout">

    <!-- Left: Pond -->
    <div class="pond-wrapper">
        <img src="pond.png" class="pond">
        <div id="pondDrawings" class="drawing-container"></div>
    </div>

    <!-- Right: Tools -->
    <div class="toolbox">

        <h2 class="tool-title">Add flowers to our garden?</h2>

        <div class="colors-and-canvas">

            <div class="color-column">
                <div class="color-dot" style="background:#c43a3a" onclick="selectColor('#c43a3a')"></div>
                <div class="color-dot" style="background:#f57c00" onclick="selectColor('#f57c00')"></div>
                <div class="color-dot" style="background:#f9d66b" onclick="selectColor('#f9d66b')"></div>
                <div class="color-dot" style="background:#f9a7c1" onclick="selectColor('#f9a7c1')"></div>
                <div class="color-dot" style="background:#1f4d2d" onclick="selectColor('#1f4d2d')"></div>
            </div>

            <canvas id="draw-area"></canvas>

        </div>

        <button onclick="addToPond()">üå± Plant</button>

    </div>
</div>

<a href="gallery.html" class="gallery-link">üñºÔ∏è See flower gallery</a>

<script>
// DRAWING LOGIC
const canvas = document.getElementById("draw-area");
const ctx = canvas.getContext("2d");
canvas.width = 240;
canvas.height = 240;

let drawing = false;
let currentColor = "#1f4d2d";

function selectColor(c) { currentColor = c; }

canvas.addEventListener("mousedown", () => drawing = true);
canvas.addEventListener("mouseup", () => drawing = false);
canvas.addEventListener("mousemove", draw);

function draw(e) {
    if (!drawing) return;
    const rect = canvas.getBoundingClientRect();
    ctx.fillStyle = currentColor;
    ctx.beginPath();
    ctx.arc(e.clientX - rect.left, e.clientY - rect.top, 6, 0, Math.PI * 2); // slightly bigger
    ctx.fill();
}

// ADD TO POND + SAVE TO DB
async function addToPond() {
    const imgData = canvas.toDataURL();

    await fetch("/api/addItem", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({
            img: imgData,
            x: Math.random() * 80 + 10, 
            y: Math.random() * 60 + 20,
            timestamp: Date.now()
        })
    });

    alert("Added to Pond!");
    canvas.getContext("2d").clearRect(0, 0, canvas.width, canvas.height);
    loadPondItems();
}

// LOAD POND ITEMS
async function loadPondItems() {
    const items = await fetch("/api/getItems").then(r => r.json());
    const container = document.getElementById("pondDrawings");
    container.innerHTML = "";

    items.forEach((item, i) => {
        setTimeout(() => {
            let img = document.createElement("img");
            img.src = item.img;
            img.style.left = item.x + "%";
            img.style.top = item.y + "%";
            // Add slight delay variation to floating animation for natural effect
            img.style.animationDelay = `${(i % 5) * 0.2}s`;
            container.appendChild(img);
        }, i * 250);
    });
}

loadPondItems();
</script>

</body>
</html>
